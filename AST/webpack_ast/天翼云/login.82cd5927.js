(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{"1f3a4":function(e,t,a){"use strict";var r=a("323e"),s=a.n(r);s.a},"323e":function(e,t,a){},"51e0":function(e,t,a){e.exports=a.p+"img/ctyunlogo.620efe82.png"},ebb0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login-page"},[r("header",[r("i",{staticClass:"iconfont icon-close",on:{click:e.closeLoginPage}})]),r("main",[r("img",{staticClass:"logo",attrs:{alt:"",src:a("51e0")}}),r("div",{staticClass:"form"},[r("div",{staticClass:"form-cell account"},[r("div",{staticClass:"input-wrapper"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.account.value,expression:"form.account.value"}],attrs:{placeholder:e.form.account.placeholder,type:"text"},domProps:{value:e.form.account.value},on:{blur:e.hideAssist,focus:e.changeAccount,input:[function(t){t.target.composing||e.$set(e.form.account,"value",t.target.value)},e.changeAccount]}}),r("div",{directives:[{name:"show",rawName:"v-show",value:e.assist.show&&e.assist.list.length,expression:"assist.show && assist.list.length"}],staticClass:"assist-wrapper"},[r("ul",{staticClass:"emails-wrapper"},e._l(e.assist.list,(function(t,a){return r("li",{key:a,on:{click:function(a){return e.handleSelectEmail(t)}}},[e._v(e._s(e.getVal(e.form.account.value))+e._s(t))])})),0)]),e.isShowClearIcon?r("i",{staticClass:"iconfont icon-reject",on:{click:function(t){e.form.account.value=""}}}):e._e()])]),r("div",{staticClass:"form-cell password"},[r("div",{staticClass:"input-wrapper"},["checkbox"===e.form.password.type?r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password.value,expression:"form.password.value"}],attrs:{placeholder:e.form.password.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(e.form.password.value)?e._i(e.form.password.value,null)>-1:e.form.password.value},on:{change:function(t){var a=e.form.password.value,r=t.target,s=!!r.checked;if(Array.isArray(a)){var o=null,n=e._i(a,o);r.checked?n<0&&e.$set(e.form.password,"value",a.concat([o])):n>-1&&e.$set(e.form.password,"value",a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.form.password,"value",s)}}}):"radio"===e.form.password.type?r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password.value,expression:"form.password.value"}],attrs:{placeholder:e.form.password.placeholder,type:"radio"},domProps:{checked:e._q(e.form.password.value,null)},on:{change:function(t){return e.$set(e.form.password,"value",null)}}}):r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password.value,expression:"form.password.value"}],attrs:{placeholder:e.form.password.placeholder,type:e.form.password.type},domProps:{value:e.form.password.value},on:{input:function(t){t.target.composing||e.$set(e.form.password,"value",t.target.value)}}}),""!==e.form.password.value?r("i",{staticClass:"iconfont icon-reject icon-x",on:{click:function(t){e.form.password.value=""}}}):e._e(),r("i",{staticClass:"iconfont",class:{"icon-eye-close":e.isPasswordType,"icon-eye-open":!e.isPasswordType},on:{click:e.changePasswordInputType}})])]),r("button",{staticClass:"submit",on:{click:e.login}},[e._v("登录")])]),r("ul",{staticClass:"skip-list"},e._l(e.skip.list,(function(t,a){return r("li",{key:a,staticClass:"item",on:{click:function(a){return e.handleSkipItemClick(t)}}},[e._v(e._s(t.text))])})),0)]),r("footer",[e._m(0),r("div",{staticClass:"third-login"},e._l(e.filterThirdLogin(e.thirdLogin),(function(t,a){return r("i",{key:a,staticClass:"iconfont",class:t.icon,on:{click:function(a){return e.handleThirdLoginClick(t)}}})})),0)])])},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title-wrapper"},[a("span",{staticClass:"line"}),a("span",{staticClass:"title"},[e._v("其他方式登录")]),a("span",{staticClass:"line"})])}],o=(a("6762"),a("2fdb"),a("b54a"),a("a4bb")),n=a.n(o),i=(a("ac6a"),a("ceaa"),a("b2fb")),c=a.n(i),l=(a("96cf"),a("3b8d")),u=a("db0c"),d=a.n(u),f=(a("a481"),a("7f7f"),a("7306")),p=a("7f6d"),m=a("4328"),h=a.n(m),v={name:"login",inject:["reload","onProtocolModal"],data:function(){return{referrer:{},assist:{show:!1,list:[],emails:["@163.com","@126.com","@sina.com","@189.cn","@139.com","@qq.com","@gmail.com","@hotmail.com"]},form:{account:{value:"",placeholder:"请输入天翼云账号",rule:p["M"].email,errorMsg:"请您输入正确的电子邮箱"},password:{value:"",placeholder:"请输入密码",rule:"",errorMsg:"请您输入正确的密码",type:"password"}},skip:{list:[{text:"忘记密码",link:"/auth/reset"},{text:"免费注册",link:"/auth/register"}]},thirdLogin:{wechat:{icon:"icon-wechat",key:"wechat",show:Object(p["B"])()},qq:{icon:"icon-qq",key:"qq",show:!Object(p["B"])()}}}},computed:{isShowClearIcon:function(){return this.form.account.value.length},isPasswordType:function(){return"password"===this.form.password.type}},beforeRouteEnter:function(e,t,a){a((function(e){e.referrer=t}))},created:function(){this.handleQueryEmail()},methods:{closeLoginPage:function(){var e=this,t=e.$route.query.redirect;t&&null!==e.referrer.name?e.$router.go(-1):e.$router.replace("/")},getVal:function(e){return-1!==e.indexOf("@")?e.substring(0,e.indexOf("@")):e},handleSelectEmail:function(e){var t=this;t.form.account.value=t.getVal(t.form.account.value)+e},changeAccount:function(){var e=this,t=e.form.account;if(""===t.value)return e.assist.show=!1,!1;e.assist.show=!0;var a=t.value.indexOf("@");if(-1===a)e.assist.list=e.assist.emails;else{var r=t.value.substring(a,t.value.length);e.assist.list=[],e.assist.list=e.assist.emails.filter((function(e){return-1!==e.indexOf(r)}))}},hideAssist:function(){var e=this;setTimeout((function(){e.assist.show=!1}),0)},changePasswordInputType:function(){var e=this;e.form.password.type=e.isPasswordType?"text":"password"},checkForm:function(){var e=this,t=d()(e.form).every((function(t){return!(t.rule&&!t.rule(t.value))||(e.toast(t.errorMsg),!1)}));return t},login:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,r,s,o,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this,t.form.password.value){e.next=4;break}return t.toast("请您输入密码"),e.abrupt("return",!1);case 4:if(!t.checkForm()){e.next=25;break}return a=t.form,r=a.account,s=a.password,e.prev=6,c.a.open({spinnerType:"fading-circle"}),e.next=10,Object(f["q"])({userName:Object(p["g"])(r.value),password:encodeURI(Object(p["c"])(s.value,Object(p["f"])(Object(p["g"])(r.value))))});case 10:return o=e.sent,e.next=13,t.$store.dispatch("auth/login",o.data.userInfo);case 13:return e.next=15,t.onProtocolModal({cancelCallback:t.resetFormValue,confirmCallback:t.handleRedirect});case 15:n=e.sent,n||t.handleRedirect(),e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](6),t.errorCallback(e.t0);case 22:return e.prev=22,c.a.close(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[6,19,22,25]])})));function t(){return e.apply(this,arguments)}return t}(),resetFormValue:function(){var e=this;n()(e.form).forEach((function(t){e.form[t].value=""}))},handleRedirect:function(){var e=this;e.reload(),e.$router.replace(e.$route.query.redirect||"/")},handleSkipItemClick:function(e){this.$router.push({path:e.link})},filterThirdLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.thirdLogin;return d()(e).filter((function(e){return e.show}))},handleThirdLoginClick:function(e){var t=this,a=t.$route.query.redirect||"",r=a.includes("?")||a.includes("%3F");a=r?"/my":a;var s=encodeURIComponent(a||"/my");window.open("/thirdLogin/".concat("wap","/login/").concat(e.key,"?type=0&redirect=").concat(s),"_self")},handleQueryEmail:function(){var e="";try{var t=this.$route.query.redirect,a=h.a.parse(t,{ignoreQueryPrefix:!0});a.email&&(e=window.atob(a.email))}catch(r){console.warn("incorrect email")}finally{this.form.account.value=e}}}},w=v,g=(a("1f3a4"),a("2877")),y=Object(g["a"])(w,r,s,!1,null,"89fdeff6",null);t["default"]=y.exports}}]);